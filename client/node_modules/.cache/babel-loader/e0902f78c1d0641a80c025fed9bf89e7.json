{"ast":null,"code":"import _classCallCheck from\"/var/www/git/projects/diary-of-events/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/var/www/git/projects/diary-of-events/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/var/www/git/projects/diary-of-events/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/var/www/git/projects/diary-of-events/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{Component}from'react';import{connect}from'react-redux';import{Button,Col}from'react-bootstrap';import{Formik}from'formik';import*as yup from'yup';import*as actions from'../../../store/actions/index';import{formObjectToArray,mapKeyToValue}from'../../../shared/utility';import{signupForm,formInputChanged}from'../../../shared/form-utility';import classes from'./Signup.module.css';import{Form,Alert,Spinner}from'react-bootstrap';import{Redirect}from'react-router-dom';import Aux from'../../../hoc/Aux/Aux';var Signup=/*#__PURE__*/function(_Component){_inherits(Signup,_Component);var _super=_createSuper(Signup);function Signup(){var _this;_classCallCheck(this,Signup);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={validated:false};_this.onSignupHandler=function(form){_this.setState({validated:true});_this.props.onSignup(form);_this.props.history.push(_this.props.redirect);return/*#__PURE__*/_jsx(Redirect,{to:_this.props.redirect});};_this.onCancelSignupHandler=function(){_this.props.onCancelSignup();};return _this;}_createClass(Signup,[{key:\"render\",value:function render(){var _this2=this;var errors=this.props.errors&&this.props.errors.length>0?/*#__PURE__*/_jsx(Alert,{variant:\"danger\",children:this.props.errors.map(function(err,key){var error='path'in err&&err.path.length>0&&err.path[0]==='repeat_password'?'Password must match!':err.message;return/*#__PURE__*/_jsxs(\"span\",{children:[error,\" \",/*#__PURE__*/_jsx(\"br\",{})]},key);})}):null;var signupBtnChild=this.props.loading?/*#__PURE__*/_jsxs(Aux,{children:[/*#__PURE__*/_jsx(Spinner,{as:\"span\",animation:\"grow\",size:\"sm\",role:\"status\",\"aria-hidden\":\"true\"}),\"Loading...\"]}):'Signup';var schema=yup.object({email:yup.string().required().email(),password:yup.string().required(),repeat_password:yup.string().oneOf([yup.ref('password'),null],'Passwords must match!')});return/*#__PURE__*/_jsx(Formik,{validationSchema:schema,onSubmit:this.onSignupHandler,initialValues:{email:'',password:'',repeat_password:''},children:function children(_ref){var handleSubmit=_ref.handleSubmit,handleChange=_ref.handleChange,handleBlur=_ref.handleBlur,values=_ref.values,touched=_ref.touched,isValid=_ref.isValid,errors=_ref.errors;return/*#__PURE__*/_jsxs(Form,{noValidate:true,onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(Form.Group,{as:Col,controlId:\"email\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Email\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Email\",name:\"email\",value:values.email,onChange:handleChange,isInvalid:!!errors.email}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:errors.email})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Col,controlId:\"password\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"Password\",name:\"password\",value:values.password,onChange:handleChange,isInvalid:!!errors.password}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:errors.password})]}),/*#__PURE__*/_jsxs(Form.Group,{as:Col,controlId:\"repeat_password\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Confirm Password\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"password\",placeholder:\"confirm password\",name:\"repeat_password\",value:values.repeat_password,onChange:handleChange,isInvalid:!!errors.repeat_password}),/*#__PURE__*/_jsx(Form.Control.Feedback,{type:\"invalid\",children:errors.repeat_password})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.Buttons,children:[/*#__PURE__*/_jsx(Button,{variant:\"danger\",type:\"submit\",children:signupBtnChild}),/*#__PURE__*/_jsx(Button,{variant:\"secondary\",disabled:_this2.props.loading,onClick:_this2.onCancelSignupHandler,children:\"Cancel\"})]})]});}});}}]);return Signup;}(Component);;var mapStateToProps=function mapStateToProps(state){console.log(state);return{isAuth:state.signin.token!==null,errors:state.signup.errors,redirect:state.signup.redirect,loading:state.signup.loading,toast:state.signup.toast};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{onSignup:function onSignup(data){return dispatch(actions.signup(data));},onCancelSignup:function onCancelSignup(){return dispatch(actions.signupCancel());}};};export default connect(mapStateToProps,mapDispatchToProps)(Signup);","map":{"version":3,"sources":["/var/www/git/projects/diary-of-events/src/components/Auth/Signup/Signup.js"],"names":["React","Component","connect","Button","Col","Formik","yup","actions","formObjectToArray","mapKeyToValue","signupForm","formInputChanged","classes","Form","Alert","Spinner","Redirect","Aux","Signup","state","validated","onSignupHandler","form","setState","props","onSignup","history","push","redirect","onCancelSignupHandler","onCancelSignup","errors","length","map","err","key","error","path","message","signupBtnChild","loading","schema","object","email","string","required","password","repeat_password","oneOf","ref","handleSubmit","handleChange","handleBlur","values","touched","isValid","Buttons","mapStateToProps","console","log","isAuth","signin","token","signup","toast","mapDispatchToProps","dispatch","data","signupCancel"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Button, Col} from 'react-bootstrap';\nimport { Formik } from 'formik';\nimport * as yup from 'yup';\n\nimport * as actions from '../../../store/actions/index';\nimport { formObjectToArray, mapKeyToValue } from '../../../shared/utility';\nimport { signupForm, formInputChanged} from '../../../shared/form-utility';\n\nimport classes from './Signup.module.css';\nimport { Form, Alert, Spinner } from 'react-bootstrap';\nimport { Redirect } from 'react-router-dom';\nimport Aux from '../../../hoc/Aux/Aux';\n\nclass Signup extends Component {\n    state = {\n        validated: false\n    }\n\n    onSignupHandler =  form => {\n        this.setState({ validated: true });\n        this.props.onSignup( form );\n\n        this.props.history.push( this.props.redirect );\n        return <Redirect to={ this.props.redirect} />;\n    }\n\n    onCancelSignupHandler = () => {\n        this.props.onCancelSignup();\n    }\n\n    render () {\n        const errors = this.props.errors && this.props.errors.length > 0 ? (\n            <Alert variant='danger'>\n                {\n                    this.props.errors.map( ( err, key ) => {\n                        const error = 'path' in err && err.path.length > 0 && err.path[0] === 'repeat_password' ? 'Password must match!':   err.message;\n                        return <span key={ key }>{ error } <br/></span>\n                    })\n                }\n            </Alert>\n        ): null;\n\n        const signupBtnChild = this.props.loading ? (\n            <Aux>\n                <Spinner\n                as=\"span\"\n                animation=\"grow\"\n                size=\"sm\"\n                role=\"status\"\n                aria-hidden=\"true\"\n                />\n                Loading...\n            </Aux>\n        ): 'Signup';\n\n        const schema = yup.object({\n            email: yup.string().required().email(),\n            password: yup.string().required(),\n            repeat_password: yup.string().oneOf([yup.ref('password'), null], 'Passwords must match!'),\n        });\n\n        return (\n            <Formik\n                validationSchema={schema}\n                onSubmit={this.onSignupHandler}\n                initialValues={{\n                    email: '',\n                    password: '',\n                    repeat_password: ''\n                }}\n            >\n            {({\n                handleSubmit,\n                handleChange,\n                handleBlur,\n                values,\n                touched,\n                isValid,\n                errors,\n            }) => (\n            <Form noValidate onSubmit={handleSubmit}>\n                <Form.Group as={Col} controlId=\"email\">\n                  <Form.Label>Email</Form.Label>\n                  <Form.Control\n                    type=\"text\"\n                    placeholder=\"Email\"\n                    name=\"email\"\n                    value={values.email}\n                    onChange={handleChange}\n                    isInvalid={!!errors.email}\n                  />\n                  <Form.Control.Feedback type=\"invalid\">\n                    {errors.email}\n                  </Form.Control.Feedback>\n                </Form.Group>\n                <Form.Group as={Col} controlId=\"password\">\n                    <Form.Label>Password</Form.Label>\n                    <Form.Control\n                        type=\"password\"\n                        placeholder=\"Password\"\n                        name=\"password\"\n                        value={values.password}\n                        onChange={handleChange}\n                        isInvalid={!!errors.password}\n                    />\n                      <Form.Control.Feedback type=\"invalid\">\n                        {errors.password}\n                      </Form.Control.Feedback>\n                </Form.Group>\n                <Form.Group as={Col} controlId=\"repeat_password\">\n                    <Form.Label>Confirm Password</Form.Label>\n                    <Form.Control\n                        type=\"password\"\n                        placeholder=\"confirm password\"\n                        name=\"repeat_password\"\n                        value={values.repeat_password}\n                        onChange={handleChange}\n                        isInvalid={!!errors.repeat_password}\n                    />\n                      <Form.Control.Feedback type=\"invalid\">\n                        {errors.repeat_password}\n                      </Form.Control.Feedback>\n                </Form.Group>\n                <div className={classes.Buttons}>\n                    <Button variant='danger' type=\"submit\">{ signupBtnChild }</Button>\n                    <Button variant='secondary' disabled={this.props.loading} onClick={this.onCancelSignupHandler}>Cancel</Button>\n                </div>\n            </Form>\n          )}\n        </Formik>);\n    }\n};\n\nconst mapStateToProps = state => {\n    console.log(state);\n    return {\n        isAuth: state.signin.token !== null,\n        errors: state.signup.errors,\n        redirect: state.signup.redirect,\n        loading: state.signup.loading,\n        toast: state.signup.toast\n    };\n};\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        onSignup: data => dispatch( actions.signup( data ) ),\n        onCancelSignup: () => dispatch ( actions.signupCancel () ),\n    }\n}\n\nexport default connect( mapStateToProps, mapDispatchToProps)( Signup );\n"]},"metadata":{},"sourceType":"module"}